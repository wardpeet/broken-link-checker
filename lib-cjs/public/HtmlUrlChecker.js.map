{"version":3,"file":"HtmlUrlChecker.js","names":["_events","require","_HtmlChecker","_interopRequireDefault","_parseOptions","_limitedRequestQueue","_interopRequireWildcard","_robotDirectives","_SafeEventEmitter","_streamHTML","_httpProtocol","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","_classPrivateMethodInitSpec","_checkPrivateRedeclaration","add","_classPrivateFieldInitSpec","TypeError","_classPrivateFieldGet","s","_assertClassBrand","_classPrivateFieldSet","arguments","length","_currentAuth","_currentCustomData","_currentDone","_currentPageURL","_currentResponse","_currentRobots","_htmlChecker","_htmlUrlQueue","_options","_HtmlUrlChecker_brand","WeakSet","HtmlUrlChecker","SafeEventEmitter","constructor","options","_reset","parseOptions","RequestQueue","maxSockets","rateLimit","on","ITEM_EVENT","url","auth","customData","done","response","stream","streamHTML","__cache","RobotDirectives","userAgent","_appendRobotHeaders","finalPageURL","scan","error","_completedPage","REQUEST_QUEUE_END_EVENT","emit","END_EVENT","HtmlChecker","ERROR_EVENT","HTML_EVENT","tree","robots","QUEUE_EVENT","JUNK_EVENT","result","LINK_EVENT","COMPLETE_EVENT","clearCache","dequeue","id","success","enqueue","pageURL","transitive","transitiveAuth","isPaused","numActiveLinks","numPages","numQueuedLinks","pause","resume","exports","_classPrivateFieldGet2","xRobotsTag","headers","header","PAGE_EVENT","module"],"sources":["../../lib/public/HtmlUrlChecker.js"],"sourcesContent":["import {COMPLETE_EVENT, END_EVENT, ERROR_EVENT, HTML_EVENT, JUNK_EVENT, LINK_EVENT, PAGE_EVENT, QUEUE_EVENT} from \"../internal/events\";\nimport HtmlChecker from \"./HtmlChecker\";\nimport parseOptions from \"../internal/parseOptions\";\nimport RequestQueue, {ITEM_EVENT, END_EVENT as REQUEST_QUEUE_END_EVENT} from \"limited-request-queue\";\nimport RobotDirectives from \"robot-directives\";\nimport SafeEventEmitter from \"../internal/SafeEventEmitter\";\nimport streamHTML from \"../internal/streamHTML\";\nimport {transitiveAuth} from \"../internal/http-protocol\";\n\n\n\nexport default class HtmlUrlChecker extends SafeEventEmitter\n{\n\t#currentAuth;\n\t#currentCustomData;\n\t#currentDone;\n\t#currentPageURL;\n\t#currentResponse;\n\t#currentRobots;\n\t#htmlChecker;\n\t#htmlUrlQueue;\n\t#options;\n\n\n\n\tconstructor(options)\n\t{\n\t\tsuper();\n\t\tthis.#reset();\n\n\t\tthis.#options = parseOptions(options);\n\n\t\tthis.#htmlUrlQueue = new RequestQueue(\n\t\t{\n\t\t\tmaxSockets: 1,\n\t\t\trateLimit: this.#options.rateLimit\n\t\t})\n\t\t.on(ITEM_EVENT, async (url, {auth, customData}, done) =>\n\t\t{\n\t\t\tthis.#reset();\n\n\t\t\tthis.#currentAuth = auth;\n\t\t\tthis.#currentCustomData = customData;\n\t\t\tthis.#currentDone = done;\n\t\t\tthis.#currentPageURL = url;  // @todo remove hash ?\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tconst {response, stream} = await streamHTML(this.#currentPageURL, this.#currentAuth, this.__cache, this.#options);\n\n\t\t\t\t// Is only defined for HTTP -- made null for consistency\n\t\t\t\tthis.#currentResponse = response ?? null;\n\n\t\t\t\tthis.#currentRobots = new RobotDirectives({ userAgent: this.#options.userAgent });\n\n\t\t\t\tthis.#appendRobotHeaders();\n\n\t\t\t\t// If redirected for HTTP, or original URL for non-HTTP\n\t\t\t\tconst finalPageURL = response?.url ?? this.#currentPageURL;\n\n\t\t\t\t// Passes robots instance so that headers are included in robot exclusion checks\n\t\t\t\t// @todo does the `await` cause `completedPage` to be called twice (other's in COMPLETE_EVENT) if error occurs?\n\t\t\t\tawait this.#htmlChecker.scan(stream, finalPageURL, this.#currentRobots, this.#currentAuth);\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\tthis.#completedPage(error);\n\t\t\t}\n\t\t})\n\t\t.on(REQUEST_QUEUE_END_EVENT, () =>\n\t\t{\n\t\t\t// Clear references for garbage collection\n\t\t\tthis.#reset();\n\n\t\t\tthis.emit(END_EVENT);\n\t\t});\n\n\t\tthis.#htmlChecker = new HtmlChecker(this.#options)\n\t\t.on(ERROR_EVENT, error => this.emit(ERROR_EVENT, error))\n\t\t.on(HTML_EVENT, (tree, robots) =>\n\t\t{\n\t\t\tthis.emit(HTML_EVENT, tree, robots, this.#currentResponse, this.#currentPageURL, this.#currentCustomData);\n\t\t})\n\t\t.on(QUEUE_EVENT, () => this.emit(QUEUE_EVENT))\n\t\t.on(JUNK_EVENT, result => this.emit(JUNK_EVENT, result, this.#currentCustomData))\n\t\t.on(LINK_EVENT, result => this.emit(LINK_EVENT, result, this.#currentCustomData))\n\t\t.on(COMPLETE_EVENT, () => this.#completedPage());\n\t}\n\n\n\n\t/**\n\t * Append any robot headers.\n\t */\n\t#appendRobotHeaders()\n\t{\n\t\tconst xRobotsTag = this.#currentResponse?.headers[\"x-robots-tag\"];\n\n\t\t// @todo https://github.com/nodejs/node/issues/3591\n\t\tif (xRobotsTag != null)\n\t\t{\n\t\t\tthis.#currentRobots.header(xRobotsTag);\n\t\t}\n\t}\n\n\n\n\tclearCache()\n\t{\n\t\tthis.#htmlChecker.clearCache();\n\t\treturn this;\n\t}\n\n\n\n\t/**\n\t * Emit PAGE_EVENT and continue the queue.\n\t * @param {Error} [error]\n\t */\n\t#completedPage(error = null)\n\t{\n\t\t// @todo emit page error instead?\n\t\t// @todo include redirected url if there is one?\n\t\tthis.emit(PAGE_EVENT, error, this.#currentPageURL, this.#currentCustomData);\n\n\t\t// Auto-starts next queue item, if any\n\t\t// Emits REQUEST_QUEUE_END_EVENT, if not\n\t\tthis.#currentDone();\n\t}\n\n\n\n\tdequeue(id)\n\t{\n\t\tconst success = this.#htmlUrlQueue.dequeue(id);\n\n\t\tthis.emit(QUEUE_EVENT);\n\n\t\treturn success;\n\t}\n\n\n\n\t// `auth` is undocumented and for internal use only\n\tenqueue(pageURL, customData, auth)\n\t{\n\t\t// @todo this could get messy if there're many different credentials per site (if we cache based on headers)\n\t\tconst transitive = transitiveAuth(pageURL, auth);\n\n\t\tconst id = this.#htmlUrlQueue.enqueue(transitive.url, { auth:transitive.auth, customData });\n\n\t\tthis.emit(QUEUE_EVENT);\n\n\t\treturn id;\n\t}\n\n\n\n\thas(id)\n\t{\n\t\treturn this.#htmlUrlQueue.has(id);\n\t}\n\n\n\n\tget isPaused()\n\t{\n\t\treturn this.#htmlChecker.isPaused;\n\t}\n\n\n\n\tget numActiveLinks()\n\t{\n\t\treturn this.#htmlChecker.numActiveLinks;\n\t}\n\n\n\n\tget numPages()\n\t{\n\t\treturn this.#htmlUrlQueue.length;\n\t}\n\n\n\n\tget numQueuedLinks()\n\t{\n\t\treturn this.#htmlChecker.numQueuedLinks;\n\t}\n\n\n\n\tpause()\n\t{\n\t\tthis.#htmlChecker.pause();\n\t\tthis.#htmlUrlQueue.pause();\n\t\treturn this;\n\t}\n\n\n\n\t#reset()\n\t{\n\t\tthis.#currentAuth = null;\n\t\tthis.#currentCustomData = null;\n\t\tthis.#currentDone = null;\n\t\tthis.#currentPageURL = null;\n\t\tthis.#currentResponse = null;\n\t\tthis.#currentRobots = null;\n\t}\n\n\n\n\tresume()\n\t{\n\t\tthis.#htmlChecker.resume();\n\t\tthis.#htmlUrlQueue.resume();\n\t\treturn this;\n\t}\n\n\n\n\tget __cache()\n\t{\n\t\treturn this.#htmlChecker.__cache;\n\t}\n}\n"],"mappings":"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","ignoreList":[]}